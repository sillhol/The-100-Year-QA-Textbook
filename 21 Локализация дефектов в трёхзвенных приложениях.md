# 21 Локализация дефектов в трёхзвенных приложениях
## Распространенные проблемы 3 звенных приложений
### Сторона клиента:
- Некорректное или неподдерживаемое действие пользователя.
- Неподдерживаемый тип или версия клиентского приложения.
- Некоторое ПО, обеспечивающее безопасность, препятствует доступу пользователя к серверу.
- Некоторые настройки клиентского программного обеспечения неким образом конфликтуют с конфигурацией сервера.
- Неверные учётные данные для доступа к серверу.
- Пользователь может запросить что-либо неразрешённое или запрещённое для его роли.
### Сторона сервера:
- Отсутствующие объекты файловой системы.
- Некорректные настройки прав доступа к файлам, директориям и другим объектам операционной системы или приложения.
- Проблема с правами пользователя для запуска приложения.
- Конфликты, связанные с портами.
- Недостаточное дисковое пространство для размещения временных файлов или файлов, запрошенных пользователем.
- Нехватка памяти может привести к завершению работы некоторых приложений или отказу выделить запрошенную приложением память.
### Сторона сетевая (между всеми соседними компонентами).
- Проблемы с маршрутизацией.
- Проблемы, связанные с DNS.
- Межсетевые экраны, блокирующие прохождение пакетов.
- Неправильная настройка компонентов верхнего уровня (например, неверный IP-адрес или FQDN сервера БД, некорректные учётные данные для подключения к БД, неверное название БД и т. д.).
### Сторона базы данных:
- Учётная запись в БД, используемая бэкендом, заблокирована.
- Пароль учётной записи изменён без соответствующей перенастройки бэкенд-приложения.
- Права пользователей, настроенные для бэкенд-приложения, изменены или аннулированы.
- Согласованность данных (в таблицах, пр.) нарушена.
## Пример руководства по развертыванию (Deployment guid)
### Руководство по развёртыванию (Deployment guid): фронтенд
<table>
	<tbody>
		<tr>
			<td><p>Расположение</p></td>
			<td><p>192.168.40.14</p></td>
		</tr>
		<tr>
			<td><p>Серверный TCP-порт</p></td>
			<td><p>90XY, где XY — это две последние цифры UID каждого студента в операционной системе (UID показывается командой id)</p></td>
		</tr>
		<tr>
			<td><p>Стек технологий</p></td>
			<td><p>nodejs express bootstrap</p></td>
		</tr>
		<tr>
			<td><p>Директория приложения</p></td>
			<td><p>/apps/nodejs/$USER</p></td>
		</tr>
		<tr>
			<td><p>Название службы в системе</p></td>
			<td><p>nodejs-auth.$USER</p></td>
		</tr>
		<tr>
			<td><p>Шаги для запуска</p></td>
			<td><p>sudo systemctl start nodejs-auth.$USER</p></td>
		</tr>
		<tr>
			<td><p>Основные файлы конфигурации</p></td>
			<td>
				<p>Адреса и порты бэкенда указаны в файле &nbsp;/apps/nodejs/$USER/config/default.json</p>
				<p>Порт сервера фронтенда указан в файле &nbsp;/apps/nodejs/$USER/bin/www</p>
			</td>
		</tr>
		<tr>
			<td><p>Журналы</p></td>
			<td>
				<ol>
					<li aria-level="1"><p>Можно просмотреть посредством команды journalctl.</p></li>
					<li aria-level="1"><p>Не содержит какого-либо подробного описания проблем, за исключением ошибок соединения с приложением бэкенда.</p></li>
				</ol>
				<p>journalctl -u nodejs-auth.$USER.service</p>
			</td>
		</tr>
		<tr>
			<td><p>URL</p></td>
			<td><p>http://192.168.40.14:90XY</p></td>
		</tr>
	</tbody>
</table>

### Руководство по развёртыванию (Deployment guid): бэкенд
<table>
	<tbody>
		<tr>
			<td><p>Местоположение</p></td>
			<td><p>192.168.40.100</p></td>
		</tr>
		<tr>
			<td><p>Порт TCP сервера</p></td>
			<td><p>70XY, где XY — это две последние цифры UID студента в операционной системе (UID показывается командой id)</p></td>
		</tr>
		<tr>
			<td><p>Стек технологий</p></td>
			<td><p>java springboot</p></td>
		</tr>
		<tr>
			<td><p>Директория приложения</p></td>
			<td><p>/apps/java/auth/$USER</p></td>
		</tr>
		<tr>
			<td><p>Название службы в системе</p></td>
			<td><p>java-auth.$USER</p></td>
		</tr>
		<tr>
			<td><p>Шаги для запуска</p></td>
			<td><p>sudo systemctl start java-auth.$USER</p></td>
		</tr>
		<tr>
			<td><p>Основные файлы конфигурации</p></td>
			<td><p>/apps/java/auth/$USER/application.properties</p></td>
		</tr>
		<tr>
			<td><p>Журналы</p></td>
			<td>
				<ol>
					<li aria-level="1"><p>Можно просмотреть посредством команды journalctl.</p></li>
					<li aria-level="1"><p>Заполняются при запуске приложения.</p></li>
					<li aria-level="1"><p>Корректные операции (например, вход в систему) не порождают новых записей журналов. В ходе работы приложения в журналы заносятся только ошибки.</p></li>
					<li aria-level="1"><p>Ключевые слова для поиска ошибок: ERR, WARN, SQL.</p></li>
				</ol>
				<p>journalctl -u java-auth.$USER.service</p>
			</td>
		</tr>
		<tr>
			<td><p>URL</p></td>
			<td><p>http://192.168.40.100:70XY</p></td>
		</tr>
	</tbody>
</table>

## Локализация дефектов в трёхзвенном приложении

- строить проверки таким образом, чтобы можно было проверить несколько гипотез за раз, в т.ч. и опосредованно
- знание внутреннего устройства приложения и соответствующих технологиях позволит оптимизировать процесс локализации за счет снижения количества проверок и экономии времени
  - Сначала выполняется базовая проверка надлежащей работы всех наших серверных приложений
  - Строим гипотезы, исходя из [распространенных проблем 3-звенных приложений](###распространенные-проблемы-3-звенных-приложений)
