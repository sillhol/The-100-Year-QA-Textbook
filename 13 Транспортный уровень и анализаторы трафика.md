# 13 Транспортный уровень и анализаторы трафика
TCP и UDP
Прослушиваемые порты TCP и UDP:
ОС Linux: netstat -vpntul или ss -pntul
macOS: netstat -anf inet | egrep -v 'EST|WAIT' | sort | uniq
Windows: netstat
Активные порты TCP и UDP (ESTABLISHED):
ОС Linux: netstat -vpntu
macOS: netstat -anf inet | egrep EST
Windows: netstat -a
***--
/etc/services - порты, соотнесённые с сетевыми приложениями

************************************************************
Анализаторы сетевого трафика «снифферы»
************************************************************
tcpdump:
tcpdump <options> <expression>
Опции для сбора пакетов:
-c <N>
-i <interface_name>: -i lo, -i any
-s <N>: -s 0, -s60
-w <file>
-r <file>
Опции для отображения:
-n
-nn
-X
-A
-ttt
-v / -vv / -vvv
Выражения (фильтры):
host X: host example.com, host 8.8.8.8
net X/Y: net 8.8.0.0/16
port X: "tcp and (port 22 or port 3389)", port 53
tcp / udp / icmp: tcp and port 8080, udp and not port 53, icmp
src: tcp and src host 192.168.40.150 and src port 22
dst: udp and dst host 8.8.8.8 and dst port 53
portrange X-Y: tcp and src portrange 1-1023

Wireshark

